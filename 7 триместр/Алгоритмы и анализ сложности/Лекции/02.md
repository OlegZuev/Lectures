# Лекция 2

18.09.20

## Линейные рекуррентные уравнения (ЛРУ)

x_n - числовая последовательность x_0, x_1, ..., x_i

a_0\*x_n + a_1*x_n11 + a_2*x_n-2 + a_k*n_k = f(n)

k - глубина рекуррентного уравнения уравнения (сколько элементов нужно знать, чтобы вычислить следующее значение)

Первые k элементов образуют начальные условия x_0, ..., x_k-1.

Классификация:

1. уравнение с постоянными коэффициентами: a_i, i=1..n - константы
2. уравнение с переменными коэффициентами

Классификация:

1. однородное уравнение: f(n) = 0
2. неоднородное уравнение

Решить рекуррентное уравнение значит найти уравнение n-ого элемента числовой последовательности в явном виде в виде формы, которая не зависит от номера элемента.

## Однородные ЛРУ с постоянными коэффициентами

a_0*x_n + a_1*x_n-1 + ... + a_k*x_n-k = 0

1. Составить характеристическое уравнение

    a_i = lambda^i, lambda != 0

    Получим алгебраическое уравнение в степени k.

2. Решить характеристическое уравнение

    Получим k корней: lambda_1, ..., lambda_k

    Варианты:

    1. Все корни различны

        Решение записано в виде:

        c_1*lambda_1^n + c_2*lambda_2^n + ... + c_k*lambda_k^n

    2. Среди корней есть повторяющиеся

        Всего s различных корней lambda_1 кратности k_1, ..., lambda_s кратности k_s.

        Решение уравнение в виде:

        x_n = P_k_1(n)*lambda_1^n + ... + P_k_s(n)*lambda_s^n

        где P_i(n) - полином степени i-1 с неизвестными коэффициентами

        Получится в точности k неизвестных коэффициентов

3. Найти неизвестные коэффициенты из начальных условий

Пример:

x_n = x_n-1 + x_n-1, x_0 = x_1 = 1

1. lambda^n = lambda^n-1 + lambda^n-2 | lambda^n-2 != 0

2. lambda^2 = lambda + 1

    D = 1 + 4 = 5

    lambda_1, lambda_2 = (1 +- sqrt(5)) / 2

    x_n = c_1*((1+sqrt(5))/2)^2 + c_2*((1-sqrt(5))/2)^n

3. n = 0: x_0 = C_1 + C_2 = 1

    n = 1: x_1 = C_1*(1+sqrt(5))/2 + C_2*(1-sqrt(5))/2 = 1 - система

    C_1 = (1 + sqrt(5))/2sqrt(5)

    C_2 = (sqrt(5) - 1)/2sqrt(5)

    x_n = (1 + sqrt(5))/2sqrt(5)*((1+sqrt(5))/2)^2 + (sqrt(5) - 1)/2sqrt(5)*((1-sqrt(5))/2)^n

    Функция растет и растет экспоненциально.

## Неоднородные ЛРУ

a_0*x_n + a_1*x_n-1 + ... + a_k*x_n-k = f(n) != 0

1. Найти общее решение однородного уравнение (т. е. без нахождения неизвестных коэффициентов)

2. Найти частное решение неоднородного уравнения по виду неоднородности f(n)

    1. f(n) = P_m(n) - полином

        Если число 1 является корнем характеристического уравнения, возникшее при решении однородного уравнения, кратности s, то частное решение x_n^ч.н. = n^s * R_m(n). _Этот случай называется резонансом._

        Если кратность 1, то x_n^ч.н. = R_m(n).

    2. f(n) = P_m(n) * q^n, где q - константа

        Если число q является корнем характеристического уравнения кратности s, то частное решение x_n = n^s * R_m(n) * q^n. _Этот случай называется резонансом._

        Если не является, то x_n = R_m(n) * q^n.

    Коэффициенты полинома R_m(n) находятся подстановкой x_n^ч.н. в исходное уравнение (должно получиться тождество).

3. Получить решение исходного уравнения

    x_n = x_n^о.о. + x_n^ч.н., где x_n^о.о. найдено на первом шаге, x_n^ч.н. найдено на втором шаге.

4. Найти неизвестные коэффициенты из начальных условий

Пример:

x_n = 2x_n-1 + 2^n, x_0=0

1. о.о.: x_n = 2x_n-1

    lambda^n = 2lambda^n-1

    lambda=2

    x_n^о.о. = c_1*2^n

2. q = 2 - корень характеристического уравнения кратности 1

    x_n^ч.н. = n*R_0(n)*2^n = n*a*2^n

    n*a*2^n = 2*(n-1)a*2^(n-1) + 2^n

    n*a = an - a + 1

    a = 1

    x_n^ч.н. = n*2^n

3. x_n = x_n^о.о. + x_n^ч.н. = c_1*2^n + n*2^n

    x_0 = C_1 - 0 = 0

    C_1 = 0

    Ответ: x_n = n*2^n

## Сложность рекурсивных алгоритмов

```md
alpha(x)
{
    общая часть;
    if (x = s)
    then тривиальная часть;
    else { alpha(y); прочие действия; }
}
```

1. Если происходит рекурсивный вызов, то t_alpha(x) = t_общая(x) + t_проверка_условия(x) + t_alpha(y) + t_вычисления(y) + t_прочие_действия(x) (1)

2. Рекурсивного вызова не происходит t_alpha(s) = t_общая(s) + t_проверка_условия(s) + t_тривиальная_часть(s) (2)

t_alpha(x) -> z_n, где n - объем входных данных от x.

(1) - рекуррентное уравнение, (2) - начальные условия.

Пример

```cpp
int f(int n)
{
    if (n == 1)
        return 1;
    else return n * f(n - 1)
}
```

t_f(n) = 1 + t_f(n-1) + 1 + 1 + 1 = 4 + t_f(n-1) (1)

t_f(1) = 1 + 1 = 2

t_f(n) -> z_n

(1) => 4 + z_n-1; z_1 = 2

z_n = z_n-1

lambda = 1

z_n^о.о. = C_1

1 - корень характеристического уравнения

z_1^ч.н. = na

a = 4 + (n-1)a => a = 4

z_n = C_1 + 4n

z_1 = C_1 + 4 = 2

z_n = 4n - 2

Ответ: t_f^*(n) = 4n - 2 ~ O(n)

## Переменная глубина

```md
t_alpha(n) = a*t_alpha(h/d) + b*n^k
Пусть n = d^m, тогда
t_alpha(d^m) = a*t_alpha(d^(m-1)) + b*(d^m)^k
z_m = a*z_m-1 + b*a^(m*k)
z_m^о.о. = c_1*a^m
lambda = a
d^(m*k) = (d^k)^m
q = d^k

1. d^k = a
   z_m^ч.н. = m*a*d^(m*k)

2. d^k != a
   z_m^ч.н. = a*d^(m*k)
```

Тогда:

```md
1. z_m = C_1*a^m + m*a*d^(m*k) (d^k = a)
2. z_m = C_1*a^m + a*d^(mk)

1. t_alpha(d^m) = C_1*a^m + m*a*d^(mk) (d^k != a)
2. t_alpha(d^m) = C_1*a^m + a*d^(mk)

1. t_alpha(n) ~ O(log(n) * n^k) (d^k = a)
2. t_alpha(n) ~ O(n^k) (d^k > a)
3. t_alpha(n) ~ (...) (d^k < a)
```
