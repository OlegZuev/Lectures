# Лаба 4-1

19.02.20

- [Лаба 4-1](#Лаба-4-1)
  - [Продолжение](#Продолжение)
    - [1 НФ](#1-НФ)
    - [2 НФ](#2-НФ)
    - [3 НФ и 4 НФ](#3-НФ-и-4-НФ)
  - [Переформулируем условие задачи](#Переформулируем-условие-задачи)
    - [НФ элементарных ключей](#НФ-элементарных-ключей)
    - [Усиленная 3 НФ](#Усиленная-3-НФ)
    - [4 НФ](#4-НФ)

## Продолжение

### 1 НФ

Волшебник(v_name, v_bd), регистрирующий номер(r_id, r_name), федерации (f_id, f_name).

1:М, 1:М.

- r_id -> r_name, f_id, f_name
- f_id -> f_name
- f_name, f_id -> v_bd, r_name, f_id, f_name

### 2 НФ

1. r_name*, r_id*, v_bd - волшебники
2. r_id*, r_name, f_id, f_name - регистрирующие органы

### 3 НФ и 4 НФ

1. v_name*, r_id*, v_bd - волшебники
2. r_id*, r_name, f_id - регистрирующие органы
3. f_id*, f_name - федерации

## Переформулируем условие задачи

Волшебник(v_vid, v_name, v_bd), регистрирующий номер(r_id, r_name), федерации (f_id, f_name).

Зависимость между именами и ИД волшебников.

v_vid может быть первичным ключом.

- r_id -> r_name, f_id, f_name
- f_id -> f_name
- r_name, r_id -> v_bd
- v_vid, r_id -> v_bd
- v_name <-> v_vid

1. v_name*, r_id*, v_bd, v_vid - волшебники
2. r_id*, r_name, f_id - регистрирующие органы
3. f_id*, f_name - федерации

Кажется, что v_vid зависит от (v_name, r_id).

На самом деле нет. На 2 НФ надо выносить неключевые поля, т. е. поля, которые не состоят ни в одном потенциальном ключе.

### НФ элементарных ключей

Несколько потенциальных полей, пересекающихся по определенным атрибутам.

1. v_name*, r_id*, v_bd - волшебники
2. r_id*, r_name, f_id - регистрирующие органы
3. f_id*, f_name - федерации
4. (unique) v_name*, (unique) v_vid

### Усиленная 3 НФ

Волшебник(v_name, v_bd), регистрирующий номер(r_id, r_name), федерации (f_id, f_name, v_reg_no).

- r_id -> r_name, f_id, f_name
- f_id -> f_name
- r_name, r_id -> v_bd, v_reg_no
- v_reg_no -> r_id

Потенциальные ключи: (f_id, f_name), (v_reg_no).

(AB->C)

(C->B)

1. v_name*, r_id*, v_bd, v_reg_no - волшебники
2. r_id*, r_name, f_id - регистрирующие органы
3. f_id*, f_name - федерации

Переделаем в:

1. v_name*, v_bd, v_reg_no* - волшебники (A->C)
2. r_id*, r_name, f_id - регистрирующие органы
3. f_id*, f_name - федерации
4. v_reg_no*, r_id (C->B)

Мы потеряли связь (AB->C).

### 4 НФ

Регистрирующие органы (r_id, r_name).

Федерация (f_id, f_name).

Планеты (p_id, p_home).

p_id -> f_id

Планеты : федерации : рег. органы.

1:М, М:1.

Ключ: p_id, r_id.

По сути Декартово произведение (p_id x r_id).

Это отношение не несет никакого смысла.

ИД федерации имеет __многозначную зависимость__ по ИД планет и ИД регистрирующих органов.

f_id ->> r_id | p_id

Можно разделить на два таблицы: "Планеты" и "Регистрирующие органы". Отношение (p_id, r_id) пропадает.
